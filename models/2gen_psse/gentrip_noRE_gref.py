psspy.read(0,r"""C:\Users\bwang2\Documents\GitHub\emt\models\2gen_psse\2gen_noRE_v33_mod.raw""")
psspy.dyre_new([1,1,1,1],r"""C:\Users\bwang2\Documents\GitHub\emt\models\2gen_psse\2gen_noRE.dyr""","","","")

psspy.plmod_status(1,r"""1""",6,0)
psspy.plmod_status(4,r"""1""",6,0)
# psspy.plmod_status(1,r"""1""",7,0)
# psspy.plmod_status(4,r"""1""",7,0)

psspy.cong(0)
## constant P load
# psspy.conl(0, 1, 1, [0, 0], [100.0, 0.0, 0.0, 100.0])
# psspy.conl(0, 1, 2, [0, 0], [100.0, 0.0, 0.0, 100.0])
# psspy.conl(0, 1, 3, [0, 0], [100.0, 0.0, 0.0, 100.0])
## constant Z load
psspy.conl(0,1,1,[0,0],[0.0, 100.0,0.0, 100.0])
psspy.conl(0,1,2,[0,0],[0.0, 100.0,0.0, 100.0])
psspy.conl(0,1,3,[0,0],[0.0, 100.0,0.0, 100.0])
psspy.chsb(0,1,[-1,-1,-1,1,1,0])
psspy.chsb(0,1,[-1,-1,-1,1,2,0])
psspy.chsb(0,1,[-1,-1,-1,1,3,0])
psspy.chsb(0,1,[-1,-1,-1,1,4,0])
psspy.chsb(0,1,[-1,-1,-1,1,5,0])
psspy.chsb(0,1,[-1,-1,-1,1,6,0])
psspy.chsb(0,1,[-1,-1,-1,1,7,0])
psspy.chsb(0,1,[-1,-1,-1,1,14,0])
psspy.chsb(0,1,[-1,-1,-1,1,16,0])
psspy.chsb(0, 1, [-1, -1, -1, 1, 21, 0])
psspy.chsb(0, 1, [-1, -1, -1, 1, 11, 0])
psspy.chsb(0, 1, [-1, -1, -1, 1, 27, 0])
psspy.chsb(0, 1, [-1, -1, -1, 1, 3, 0])  # QELEC, machine reactive power

psspy.state_channel([43,17],r"""M1_xe""")
psspy.state_channel([44,18],r"""M1_xc""")
psspy.state_channel([45,19],r"""M1_xg""")
psspy.state_channel([46,20],r"""M1_xq""")
psspy.var_channel([47,1] ,"""M1_Speed ref""")
psspy.var_channel([48,2] ,"""M1_h""")

# psspy.state_channel([41,1],r"""M1_Eqp""")
# psspy.state_channel([42,2],r"""M1_Edp""")
# psspy.state_channel([43,3],r"""M1_psykd""")
# psspy.state_channel([44,4],r"""M1_psykq""")
# psspy.state_channel([45,5],r"""M1_speed""")
# psspy.state_channel([46,6],r"""M1_angle""")
# psspy.state_channel([47,7],r"""M2_Eqp""")
# psspy.state_channel([48,8],r"""M2_Edp""")
# psspy.state_channel([49,9],r"""M2_psykd""")
# psspy.state_channel([50,10],r"""M2_psykq""")
# psspy.state_channel([51,11],r"""M2_speed""")
# psspy.state_channel([52,12],r"""M2_angle""")
# psspy.var_channel([41,1] ,"""Memory""")
# psspy.var_channel([42,2] ,"""dvmdt""")
# psspy.state_channel([43,13] ,"""y1""")
# psspy.state_channel([44,14] ,"""y2""")
# psspy.state_channel([45,15] ,"""y3""")
# psspy.state_channel([46,16] ,"""y4""")
# psspy.state_channel([47,17] ,"""y5""")
# psspy.state_channel([48,18] ,"""y6""")
# psspy.state_channel([49,19] ,"""y7""")

# psspy.chsb(0, 1, [-1, -1, -1, 1, 10, 0])  # PSS output


psspy.dynamics_solution_param_2([_i,_i,_i,_i,_i,_i,_i,_i],[_f,_f, 0.001,_f,_f,_f,_f,_f])
psspy.strt_2([0,0],r"""C:\Users\bwang2\Documents\GitHub\emt\models\2gen_psse\out.out""")
psspy.run(0, 1,0,2,2)
# psspy.dist_machine_trip(4,r"""1""")
# psspy.change_gref(4,r"""1""",-0.02)
psspy.increment_gref(4,r"""1""",-0.02)
psspy.run(0, 15,0,2,2)
