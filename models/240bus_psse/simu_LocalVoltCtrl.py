# File:"C:\Users\bwang2\Desktop\Hi RE Penetration\simu.py", generated on THU, SEP 30 2021  16:05, PSS(R)E release 34.04.00
# psspy.read(0,r"""C:\Users\bwang2\Desktop\Hi RE Penetration\WECC240_v04_DPV_RE20.raw""")
psspy.read(0,r"""C:\Users\bwang2\Documents\GitHub\emt\models\240bus_psse\WECC240_v04_DPV_RE20_v33_6302_xfmr_DPbuscode_PFadjusted.raw""")
psspy.dyre_new([1,1,1,1],r"""C:\Users\bwang2\Documents\GitHub\emt\models\240bus_psse\WECC240_dynamics_UPV_v04_all.dyr""","","","")

psspy.machine_chng_2(2438,r"""ND""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(3835,r"""ND""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(3933,r"""ND""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(3133,r"""SC""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(7031,r"""SC""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(7031,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(1131,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(1232,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(2233,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(2630,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(3135,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(3234,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(3333,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(3836,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(4035,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(4231,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(4232,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(6333,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(6433,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])
psspy.machine_chng_2(8034,r"""S""",[_i,_i,_i,_i,_i,_i],[ 0.0001,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f,_f])


# set S(1.0)=S(1.2)=0 for all machines
psspy.change_plmod_con(1032,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1032,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(1032,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1032,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(1034,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1034,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(1034,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1034,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(1131,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1131,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(1131,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1131,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(1232,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1232,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(1232,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1232,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(1331,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1331,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(1331,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1331,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(1333,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1333,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(1333,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1333,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(1431,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1431,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(1431,r"""N""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(1431,r"""N""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2030,r"""E""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2030,r"""E""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2030,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2030,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2130,r"""E""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2130,r"""E""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2130,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2130,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2130,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2130,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2233,r"""DG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2233,r"""DG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2233,r"""EG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2233,r"""EG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2233,r"""TG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2233,r"""TG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2438,r"""EG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2438,r"""EG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2438,r"""ND""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2438,r"""ND""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2438,r"""RG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2438,r"""RG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2438,r"""SG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2438,r"""SG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2438,r"""SH""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2438,r"""SH""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2438,r"""WG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2438,r"""WG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2630,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2630,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2634,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2634,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2637,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2637,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(2638,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(2638,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3133,r"""NG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3133,r"""NG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3133,r"""SC""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3133,r"""SC""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3135,r"""MG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3135,r"""MG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3135,r"""NG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3135,r"""NG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3234,r"""DG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3234,r"""DG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3234,r"""MG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3234,r"""MG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3234,r"""NG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3234,r"""NG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3333,r"""CG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3333,r"""CG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3333,r"""NG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3333,r"""NG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3432,r"""NP""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3432,r"""NP""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3433,r"""NG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3433,r"""NG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3531,r"""CE""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3531,r"""CE""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3531,r"""NE""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3531,r"""NE""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3531,r"""NH""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3531,r"""NH""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3631,r"""NB""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3631,r"""NB""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3631,r"""NG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3631,r"""NG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3731,r"""NH""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3731,r"""NH""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3831,r"""NN""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3831,r"""NN""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3835,r"""ND""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3835,r"""ND""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3835,r"""NG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3835,r"""NG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3836,r"""DG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3836,r"""DG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3931,r"""NB""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3931,r"""NB""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3931,r"""NH""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3931,r"""NH""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3933,r"""CG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3933,r"""CG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3933,r"""NB""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3933,r"""NB""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3933,r"""ND""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3933,r"""ND""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3933,r"""NG""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3933,r"""NG""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(3933,r"""NH""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(3933,r"""NH""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4031,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4031,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4031,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4031,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4035,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4035,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4035,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4035,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4035,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4035,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4039,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4039,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4039,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4039,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4131,r"""B""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4131,r"""B""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4131,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4131,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4132,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4132,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4132,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4132,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4132,r"""N""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4132,r"""N""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4231,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4231,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4231,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4231,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4231,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4231,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4232,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4232,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(4232,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(4232,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(5031,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(5031,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(5031,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(5031,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(5032,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(5032,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(5032,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(5032,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(5032,r"""R""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(5032,r"""R""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6132,r"""B""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6132,r"""B""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6132,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6132,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6132,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6132,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6231,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6231,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6231,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6231,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6235,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6235,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6235,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6235,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6333,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6333,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6335,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6335,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6335,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6335,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6335,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6335,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6433,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6433,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6433,r"""E""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6433,r"""E""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6433,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6433,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6533,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6533,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6533,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6533,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(6533,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(6533,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(7031,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(7031,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(7031,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(7031,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(7031,r"""P""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(7031,r"""P""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(7031,r"""SC""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(7031,r"""SC""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(7032,r"""C""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(7032,r"""C""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(7032,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(7032,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(7032,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(7032,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(8033,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(8033,r"""H""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(8034,r"""G""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(8034,r"""G""",r"""GENROU""",14,0.0)
psspy.change_plmod_con(8034,r"""H""",r"""GENROU""",13,0.0)
psspy.change_plmod_con(8034,r"""H""",r"""GENROU""",14,0.0)

# change gen to local volt control
psspy.plant_chng(1003,0,[0.9734,_f])
psspy.plant_chng(1004,0,[1.0413,_f])
psspy.plant_chng(1032,0,[1.017,_f])
psspy.plant_chng(1034,0,[1.0439,_f])
psspy.plant_chng(1101,0,[1.01,_f])
psspy.plant_chng(1131,0,[1.0108,_f])
psspy.plant_chng(1232,0,[1.0808,_f])
psspy.plant_chng(1301,0,[1.045,_f])
psspy.plant_chng(1303,0,[1.005,_f])
psspy.plant_chng(1331,0,[1.0451,_f])
psspy.plant_chng(1333,0,[1.0088,_f])
psspy.plant_chng(1401,0,[1.035,_f])
psspy.plant_chng(1402,0,[1.0581,_f])
psspy.plant_chng(1431,0,[1.0407,_f])
psspy.plant_chng(2030,0,[1.0015,_f])
psspy.plant_chng(2130,0,[1.0358,_f])
psspy.plant_chng(2202,0,[0.9841,_f])
psspy.plant_chng(2203,0,[1.005,_f])
psspy.plant_chng(2233,0,[1.0075,_f])
psspy.plant_chng(2332,0,[1.0356,_f])
psspy.plant_chng(2400,0,[1.0244,_f])
psspy.plant_chng(2401,0,[1.0497,_f])
psspy.plant_chng(2402,0,[1.0298,_f])
psspy.plant_chng(2403,0,[1.0228,_f])
psspy.plant_chng(2405,0,[1.0125,_f])
psspy.plant_chng(2406,0,[1.0082,_f])
psspy.plant_chng(2407,0,[0.9714,_f])
psspy.plant_chng(2408,0,[1.009,_f])
psspy.plant_chng(2409,0,[1.02,_f])
psspy.plant_chng(2410,0,[1.007,_f])
psspy.plant_chng(2411,0,[1.0202,_f])
psspy.plant_chng(2431,0,[1.05,_f])
psspy.plant_chng(2434,0,[1.02,_f])
psspy.plant_chng(2438,0,[1.0098,_f])
psspy.plant_chng(2439,0,[1.0198,_f])
psspy.plant_chng(2502,0,[1.0223,_f])
psspy.plant_chng(2503,0,[1.009,_f])
psspy.plant_chng(2533,0,[1.01,_f])
psspy.plant_chng(2613,0,[0.9946,_f])
psspy.plant_chng(2615,0,[1.0056,_f])
psspy.plant_chng(2618,0,[1.0125,_f])
psspy.plant_chng(2630,0,[1.0049,_f])
psspy.plant_chng(2631,0,[1.018,_f])
psspy.plant_chng(2634,0,[1.062,_f])
psspy.plant_chng(2637,0,[1.0153,_f])
psspy.plant_chng(2638,0,[1.0202,_f])
psspy.plant_chng(3101,0,[0.9858,_f])
psspy.plant_chng(3103,0,[1,_f])
psspy.plant_chng(3104,0,[0.9873,_f])
psspy.plant_chng(3133,0,[1.0011,_f])
psspy.plant_chng(3135,0,[1.0004,_f])
psspy.plant_chng(3201,0,[0.9958,_f])
psspy.plant_chng(3202,0,[0.996,_f])
psspy.plant_chng(3203,0,[0.9979,_f])
psspy.plant_chng(3204,0,[1.01,_f])
psspy.plant_chng(3205,0,[0.998,_f])
psspy.plant_chng(3234,0,[1.0121,_f])
psspy.plant_chng(3302,0,[0.9852,_f])
psspy.plant_chng(3303,0,[1,_f])
psspy.plant_chng(3304,0,[0.9896,_f])
psspy.plant_chng(3305,0,[0.9981,_f])
psspy.plant_chng(3333,0,[1.0023,_f])
psspy.plant_chng(3401,0,[0.979,_f])
psspy.plant_chng(3403,0,[1,_f])
psspy.plant_chng(3404,0,[0.9911,_f])
psspy.plant_chng(3405,0,[0.9693,_f])
psspy.plant_chng(3432,0,[1.0007,_f])
psspy.plant_chng(3433,0,[1.0002,_f])
psspy.plant_chng(3501,0,[1,_f])
psspy.plant_chng(3531,0,[1.0006,_f])
psspy.plant_chng(3631,0,[1.015,_f])
psspy.plant_chng(3731,0,[1.0006,_f])
psspy.plant_chng(3805,0,[1.035,_f])
psspy.plant_chng(3831,0,[1.0491,_f])
psspy.plant_chng(3835,0,[1.0357,_f])
psspy.plant_chng(3836,0,[1.019,_f])
psspy.plant_chng(3907,0,[0.9727,_f])
psspy.plant_chng(3913,0,[0.983,_f])
psspy.plant_chng(3918,0,[0.9937,_f])
psspy.plant_chng(3923,0,[1.0155,_f])
psspy.plant_chng(3924,0,[0.9922,_f])
psspy.plant_chng(3931,0,[1.0715,_f])
psspy.plant_chng(3932,0,[1,_f])
psspy.plant_chng(3933,0,[1.02,_f])
psspy.plant_chng(4009,0,[1.1301,_f])
psspy.plant_chng(4031,0,[1.0857,_f])
psspy.plant_chng(4035,0,[1.128,_f])
psspy.plant_chng(4039,0,[1.137,_f])
psspy.plant_chng(4131,0,[1.1327,_f])
psspy.plant_chng(4132,0,[1.0998,_f])
psspy.plant_chng(4201,0,[1.1076,_f])
psspy.plant_chng(4231,0,[1.1216,_f])
psspy.plant_chng(4232,0,[1.0596,_f])
psspy.plant_chng(5031,0,[1.0444,_f])
psspy.plant_chng(5032,0,[1.0613,_f])
psspy.plant_chng(6104,0,[1.0483,_f])
psspy.plant_chng(6132,0,[1.1322,_f])
psspy.plant_chng(6204,0,[1.1017,_f])
psspy.plant_chng(6231,0,[1.1197,_f])
psspy.plant_chng(6235,0,[1.0776,_f])
psspy.plant_chng(6303,0,[1.13,_f])
psspy.plant_chng(6333,0,[1.1362,_f])
psspy.plant_chng(6335,0,[1.0651,_f])
psspy.plant_chng(6401,0,[1.0214,_f])
psspy.plant_chng(6433,0,[1.113,_f])
psspy.plant_chng(6510,0,[0.928,_f])
psspy.plant_chng(6533,0,[1.0679,_f])
psspy.plant_chng(7001,0,[1.05,_f])
psspy.plant_chng(7031,0,[1.06,_f])
psspy.plant_chng(7032,0,[1.01,_f])
psspy.plant_chng(8003,0,[1.075,_f])
psspy.plant_chng(8004,0,[1,_f])
psspy.plant_chng(8005,0,[0.9741,_f])
psspy.plant_chng(8033,0,[1.0776,_f])
psspy.plant_chng(8034,0,[1.0033,_f])


psspy.fnsl([0,0,0,1,1,0,0,0])
psspy.fnsl([0,0,0,1,1,0,0,0])
psspy.fnsl([0,0,0,1,1,0,0,0])

psspy.cong(0)
psspy.conl(0,1,1,[0,0],[ 100.0,0.0,0.0, 100.0])
psspy.conl(0,1,2,[0,0],[ 100.0,0.0,0.0, 100.0])
psspy.conl(0,1,3,[0,0],[ 100.0,0.0,0.0, 100.0])
psspy.chsb(0,1,[-1,-1,-1,1,2,0])
psspy.chsb(0,1,[-1,-1,-1,1,7,0])
psspy.chsb(0,1,[-1,-1,-1,1,12,0])
psspy.chsb(0,1,[-1,-1,-1,1,13,0])

# psspy.state_channel([887,1258],r"""Iqc_1003""")
# psspy.state_channel([888,1259],r"""Ipc_1003""")
# psspy.state_channel([889,1260],r"""Vflt_1003""")
# psspy.var_channel([60,779],r"""M1_gast_LoadRef""")

psspy.strt_2([0,0],r"""C:\Users\bwang2\Documents\GitHub\emt\models\240bus_psse\out""")
psspy.run(0, 0.3,0,4,2)
# # psspy.dist_machine_trip(1431,r"""N""")
# psspy.dist_machine_trip(1004,r"""DP""")
# psspy.run(0, 2.0,0,4,2)
